# 認証ページE2Eテスト仕様書

生成日: 2025-11-01
対象ページ: /auth
テスト環境: モック実装
作成者: E2Eテスト仕様書作成エージェント

## 概要
- 総テスト項目数: 62項目
- 高優先度: 28項目
- 中優先度: 22項目
- 低優先度: 12項目

## テスト項目一覧

| No | テストID | テスト項目 | 依存テストID | 機能分類 | テスト分類 | 優先度 | 確認内容 | テストデータ/手順 | 期待結果 | 実施日 | 結果 | 備考 |
|----|---------|----------|------------|---------|-----------|--------|---------|------------------|----------|--------|------|------|
| 1 | E2E-AUTH-001 | ログイン画面の初期表示 | なし | 画面表示 | 正常系 | 高 | ログイン画面が正しく表示される | /auth にアクセス | ・ロゴ「COM:PASS」が表示される<br>・「ライフ・ワークガバナンス プラットフォーム」のサブテキストが表示される<br>・「ログイン」タイトルが表示される<br>・メールアドレス入力欄が表示される<br>・パスワード入力欄が表示される<br>・「ログイン」ボタンが表示される<br>・「パスワードを忘れた場合」リンクが表示される<br>・「新規登録」リンクが表示される | | | |
| 2 | E2E-AUTH-002 | URLパラメータでログイン画面表示 | なし | 画面表示 | 正常系 | 中 | URLパラメータ?view=loginでログイン画面が表示される | /auth?view=login にアクセス | ログイン画面が表示される | | | |
| 3 | E2E-AUTH-003 | ログイン成功 | E2E-AUTH-001 | 認証 | 正常系 | 高 | 正しい認証情報でログインできる | 1. メールアドレスに「test@mentalbase.local」を入力<br>2. パスワードに「MentalBase2025!Dev」を入力<br>3. 「ログイン」ボタンをクリック | ・ボタンが「ログイン中...」に変わる<br>・ボタンが無効化される<br>・約1秒後に「/」(ホーム)にリダイレクトされる | | | モック実装 |
| 4 | E2E-AUTH-004 | ログイン失敗（メールアドレス未入力） | E2E-AUTH-001 | バリデーション | 異常系 | 高 | メールアドレス未入力でエラー表示 | 1. メールアドレスを空欄のまま<br>2. パスワードに「password123」を入力<br>3. 「ログイン」ボタンをクリック | ・メールアドレス欄の下に「メールアドレスを入力してください」エラーメッセージが赤色で表示される<br>・リダイレクトされない | | | |
| 5 | E2E-AUTH-005 | ログイン失敗（パスワード未入力） | E2E-AUTH-001 | バリデーション | 異常系 | 高 | パスワード未入力でエラー表示 | 1. メールアドレスに「test@example.com」を入力<br>2. パスワードを空欄のまま<br>3. 「ログイン」ボタンをクリック | ・パスワード欄の下に「パスワードを入力してください」エラーメッセージが赤色で表示される<br>・リダイレクトされない | | | |
| 6 | E2E-AUTH-006 | ログイン失敗（両方未入力） | E2E-AUTH-001 | バリデーション | 異常系 | 中 | 全フィールド未入力でエラー表示 | 1. メールアドレスを空欄のまま<br>2. パスワードを空欄のまま<br>3. 「ログイン」ボタンをクリック | ・メールアドレス欄の下に「メールアドレスを入力してください」エラーが表示される<br>・パスワード欄の下に「パスワードを入力してください」エラーが表示される<br>・リダイレクトされない | | | |
| 7 | E2E-AUTH-007 | ログイン失敗（メールアドレス形式エラー） | E2E-AUTH-001 | バリデーション | 異常系 | 高 | 無効なメールアドレス形式でエラー表示 | 1. メールアドレスに「invalid-email」を入力<br>2. パスワードに「password123」を入力<br>3. 「ログイン」ボタンをクリック | ・メールアドレス欄の下に「有効なメールアドレスを入力してください」エラーメッセージが表示される<br>・リダイレクトされない | | | |
| 8 | E2E-AUTH-008 | ログイン失敗（パスワード文字数不足） | E2E-AUTH-001 | バリデーション | 異常系 | 高 | 8文字未満のパスワードでエラー表示 | 1. メールアドレスに「test@example.com」を入力<br>2. パスワードに「pass」（4文字）を入力<br>3. 「ログイン」ボタンをクリック | ・パスワード欄の下に「パスワードは8文字以上で入力してください」エラーメッセージが表示される<br>・リダイレクトされない | | | |
| 9 | E2E-AUTH-009 | ログイン失敗（API認証エラー） | E2E-AUTH-001 | エラー処理 | 異常系 | 中 | API認証失敗時にエラー表示 | 1. 正しい形式だが存在しないメールアドレスを入力<br>2. パスワードを入力<br>3. 「ログイン」ボタンをクリック | ・メールアドレス欄の下に「ログインに失敗しました」エラーメッセージが表示される<br>・リダイレクトされない | | | 実装時のテスト |
| 10 | E2E-AUTH-010 | 新規登録画面への遷移 | E2E-AUTH-001 | 画面遷移 | 正常系 | 高 | ログイン画面から新規登録画面に遷移できる | 1. ログイン画面で「新規登録」リンクをクリック | ・新規登録画面が表示される<br>・URLが「/auth?view=register」になる<br>・「新規登録」タイトルが表示される<br>・お名前入力欄が表示される<br>・メールアドレス入力欄が表示される<br>・パスワード入力欄が表示される<br>・「登録してはじめる」ボタンが表示される<br>・「ログイン」リンクが表示される | | | |
| 11 | E2E-AUTH-011 | パスワードリセット画面への遷移 | E2E-AUTH-001 | 画面遷移 | 正常系 | 高 | ログイン画面からパスワードリセット画面に遷移できる | 1. ログイン画面で「パスワードを忘れた場合」リンクをクリック | ・パスワードリセット画面が表示される<br>・URLが「/auth?view=password-reset」になる<br>・「パスワードリセット」タイトルが表示される<br>・メールアドレス入力欄が表示される<br>・「リセットリンクを送信」ボタンが表示される<br>・「ログイン画面に戻る」リンクが表示される | | | |
| 12 | E2E-AUTH-012 | 新規登録画面の初期表示 | なし | 画面表示 | 正常系 | 高 | 新規登録画面が正しく表示される | /auth?view=register にアクセス | ・ロゴ「COM:PASS」が表示される<br>・「新規登録」タイトルが表示される<br>・お名前入力欄（プレースホルダー「山田 太郎」）が表示される<br>・メールアドレス入力欄（プレースホルダー「example@email.com」）が表示される<br>・パスワード入力欄（プレースホルダー「8文字以上、英数字混在推奨」）が表示される<br>・「登録してはじめる」ボタンが表示される<br>・「ログイン」リンクが表示される | | | |
| 13 | E2E-AUTH-013 | 新規登録成功 | E2E-AUTH-012 | 認証 | 正常系 | 高 | 正しい情報で新規登録できる | 1. お名前に「山田太郎」を入力<br>2. メールアドレスに「newuser@example.com」を入力<br>3. パスワードに「Password123」を入力<br>4. 「登録してはじめる」ボタンをクリック | ・ボタンが「登録中...」に変わる<br>・ボタンが無効化される<br>・約1秒後に「/」(ホーム)にリダイレクトされる | | | モック実装 |
| 14 | E2E-AUTH-014 | 新規登録失敗（名前未入力） | E2E-AUTH-012 | バリデーション | 異常系 | 高 | 名前未入力でエラー表示 | 1. お名前を空欄のまま<br>2. メールアドレスに「test@example.com」を入力<br>3. パスワードに「password123」を入力<br>4. 「登録してはじめる」ボタンをクリック | ・お名前欄の下に「名前を入力してください」エラーメッセージが赤色で表示される<br>・リダイレクトされない | | | |
| 15 | E2E-AUTH-015 | 新規登録失敗（名前2文字未満） | E2E-AUTH-012 | バリデーション | 異常系 | 中 | 2文字未満の名前でエラー表示 | 1. お名前に「A」（1文字）を入力<br>2. メールアドレスに「test@example.com」を入力<br>3. パスワードに「password123」を入力<br>4. 「登録してはじめる」ボタンをクリック | ・お名前欄の下に「名前は2文字以上で入力してください」エラーメッセージが表示される<br>・リダイレクトされない | | | |
| 16 | E2E-AUTH-016 | 新規登録失敗（メールアドレス未入力） | E2E-AUTH-012 | バリデーション | 異常系 | 高 | メールアドレス未入力でエラー表示 | 1. お名前に「山田太郎」を入力<br>2. メールアドレスを空欄のまま<br>3. パスワードに「password123」を入力<br>4. 「登録してはじめる」ボタンをクリック | ・メールアドレス欄の下に「メールアドレスを入力してください」エラーメッセージが表示される<br>・リダイレクトされない | | | |
| 17 | E2E-AUTH-017 | 新規登録失敗（メールアドレス形式エラー） | E2E-AUTH-012 | バリデーション | 異常系 | 高 | 無効なメールアドレス形式でエラー表示 | 1. お名前に「山田太郎」を入力<br>2. メールアドレスに「invalid@」を入力<br>3. パスワードに「password123」を入力<br>4. 「登録してはじめる」ボタンをクリック | ・メールアドレス欄の下に「有効なメールアドレスを入力してください」エラーメッセージが表示される<br>・リダイレクトされない | | | |
| 18 | E2E-AUTH-018 | 新規登録失敗（パスワード未入力） | E2E-AUTH-012 | バリデーション | 異常系 | 高 | パスワード未入力でエラー表示 | 1. お名前に「山田太郎」を入力<br>2. メールアドレスに「test@example.com」を入力<br>3. パスワードを空欄のまま<br>4. 「登録してはじめる」ボタンをクリック | ・パスワード欄の下に「パスワードを入力してください」エラーメッセージが表示される<br>・リダイレクトされない | | | |
| 19 | E2E-AUTH-019 | 新規登録失敗（パスワード文字数不足） | E2E-AUTH-012 | バリデーション | 異常系 | 高 | 8文字未満のパスワードでエラー表示 | 1. お名前に「山田太郎」を入力<br>2. メールアドレスに「test@example.com」を入力<br>3. パスワードに「pass12」（6文字）を入力<br>4. 「登録してはじめる」ボタンをクリック | ・パスワード欄の下に「パスワードは8文字以上で入力してください」エラーメッセージが表示される<br>・リダイレクトされない | | | |
| 20 | E2E-AUTH-020 | 新規登録失敗（全フィールド未入力） | E2E-AUTH-012 | バリデーション | 異常系 | 中 | 全フィールド未入力でエラー表示 | 1. 全フィールドを空欄のまま<br>2. 「登録してはじめる」ボタンをクリック | ・お名前欄の下に「名前を入力してください」エラーが表示される<br>・メールアドレス欄の下に「メールアドレスを入力してください」エラーが表示される<br>・パスワード欄の下に「パスワードを入力してください」エラーが表示される<br>・リダイレクトされない | | | |
| 21 | E2E-AUTH-021 | 新規登録失敗（メールアドレス重複） | E2E-AUTH-012 | エラー処理 | 異常系 | 中 | 既存メールアドレスでエラー表示 | 1. お名前に「山田太郎」を入力<br>2. メールアドレスに既存の「test@mentalbase.local」を入力<br>3. パスワードに「password123」を入力<br>4. 「登録してはじめる」ボタンをクリック | ・メールアドレス欄の下に「登録に失敗しました」エラーメッセージが表示される<br>・リダイレクトされない | | | 実装時のテスト |
| 22 | E2E-AUTH-022 | 新規登録からログイン画面への遷移 | E2E-AUTH-012 | 画面遷移 | 正常系 | 高 | 新規登録画面からログイン画面に戻れる | 1. 新規登録画面で「ログイン」リンクをクリック | ・ログイン画面が表示される<br>・URLが「/auth?view=login」になる | | | |
| 23 | E2E-AUTH-023 | パスワードリセット画面の初期表示 | なし | 画面表示 | 正常系 | 高 | パスワードリセット画面が正しく表示される | /auth?view=password-reset にアクセス | ・ロゴ「COM:PASS」が表示される<br>・「パスワードリセット」タイトルが表示される<br>・メールアドレス入力欄（プレースホルダー「example@email.com」）が表示される<br>・「リセットリンクを送信」ボタンが表示される<br>・「ログイン画面に戻る」リンクが表示される | | | |
| 24 | E2E-AUTH-024 | パスワードリセット成功 | E2E-AUTH-023 | パスワードリセット | 正常系 | 高 | パスワードリセットリクエストが成功する | 1. メールアドレスに「test@mentalbase.local」を入力<br>2. 「リセットリンクを送信」ボタンをクリック | ・ボタンが「送信中...」に変わる<br>・ボタンが無効化される<br>・約1秒後にパスワードリセット成功画面に遷移する<br>・URLが「/auth?view=password-reset-success」になる | | | モック実装 |
| 25 | E2E-AUTH-025 | パスワードリセット失敗（メールアドレス未入力） | E2E-AUTH-023 | バリデーション | 異常系 | 高 | メールアドレス未入力でエラー表示 | 1. メールアドレスを空欄のまま<br>2. 「リセットリンクを送信」ボタンをクリック | ・メールアドレス欄の下に「メールアドレスを入力してください」エラーメッセージが表示される<br>・画面遷移しない | | | |
| 26 | E2E-AUTH-026 | パスワードリセット失敗（メールアドレス形式エラー） | E2E-AUTH-023 | バリデーション | 異常系 | 高 | 無効なメールアドレス形式でエラー表示 | 1. メールアドレスに「invalid-email」を入力<br>2. 「リセットリンクを送信」ボタンをクリック | ・メールアドレス欄の下に「有効なメールアドレスを入力してください」エラーメッセージが表示される<br>・画面遷移しない | | | |
| 27 | E2E-AUTH-027 | パスワードリセット失敗（存在しないメール） | E2E-AUTH-023 | エラー処理 | 異常系 | 中 | 存在しないメールアドレスでエラー表示 | 1. メールアドレスに存在しない「nonexistent@example.com」を入力<br>2. 「リセットリンクを送信」ボタンをクリック | ・メールアドレス欄の下に「リセットリンクの送信に失敗しました」エラーメッセージが表示される<br>・画面遷移しない | | | 実装時のテスト |
| 28 | E2E-AUTH-028 | パスワードリセットからログイン画面への遷移 | E2E-AUTH-023 | 画面遷移 | 正常系 | 中 | パスワードリセット画面からログイン画面に戻れる | 1. パスワードリセット画面で「ログイン画面に戻る」リンクをクリック | ・ログイン画面が表示される<br>・URLが「/auth?view=login」になる | | | |
| 29 | E2E-AUTH-029 | パスワードリセット成功画面の表示 | E2E-AUTH-024 | 画面表示 | 正常系 | 高 | パスワードリセット成功画面が正しく表示される | パスワードリセット成功後の画面 | ・「メール送信完了」タイトルが表示される<br>・チェックアイコンが表示される<br>・「パスワードリセット用のリンクをメールで送信しました。メールをご確認ください。」メッセージが緑色の背景で表示される<br>・「ログイン画面に戻る」リンクが表示される | | | |
| 30 | E2E-AUTH-030 | パスワードリセット成功画面からログイン画面への遷移 | E2E-AUTH-029 | 画面遷移 | 正常系 | 中 | パスワードリセット成功画面からログイン画面に戻れる | 1. パスワードリセット成功画面で「ログイン画面に戻る」リンクをクリック | ・ログイン画面が表示される<br>・URLが「/auth?view=login」になる | | | |
| 31 | E2E-AUTH-031 | 新しいパスワード設定画面の初期表示 | なし | 画面表示 | 正常系 | 高 | 新しいパスワード設定画面が正しく表示される | /auth?view=new-password&token=test-token にアクセス | ・ロゴ「COM:PASS」が表示される<br>・「新しいパスワード設定」タイトルが表示される<br>・新しいパスワード入力欄（プレースホルダー「8文字以上、英数字混在推奨」）が表示される<br>・パスワード確認入力欄（プレースホルダー「もう一度入力してください」）が表示される<br>・「パスワードを変更」ボタンが表示される<br>・「ログイン画面に戻る」リンクが表示される | | | |
| 32 | E2E-AUTH-032 | 新しいパスワード設定成功 | E2E-AUTH-031 | パスワードリセット | 正常系 | 高 | 新しいパスワード設定が成功する | 1. 新しいパスワードに「NewPassword123」を入力<br>2. パスワード確認に「NewPassword123」を入力<br>3. 「パスワードを変更」ボタンをクリック | ・ボタンが「変更中...」に変わる<br>・ボタンが無効化される<br>・約1秒後にログイン画面に遷移する<br>・URLが「/auth?view=login」になる | | | モック実装 |
| 33 | E2E-AUTH-033 | 新しいパスワード設定失敗（新しいパスワード未入力） | E2E-AUTH-031 | バリデーション | 異常系 | 高 | 新しいパスワード未入力でエラー表示 | 1. 新しいパスワードを空欄のまま<br>2. パスワード確認に「password123」を入力<br>3. 「パスワードを変更」ボタンをクリック | ・新しいパスワード欄の下に「パスワードを入力してください」エラーメッセージが表示される<br>・画面遷移しない | | | |
| 34 | E2E-AUTH-034 | 新しいパスワード設定失敗（確認用パスワード未入力） | E2E-AUTH-031 | バリデーション | 異常系 | 高 | 確認用パスワード未入力でエラー表示 | 1. 新しいパスワードに「password123」を入力<br>2. パスワード確認を空欄のまま<br>3. 「パスワードを変更」ボタンをクリック | ・パスワード確認欄の下に「確認用パスワードを入力してください」エラーメッセージが表示される<br>・画面遷移しない | | | |
| 35 | E2E-AUTH-035 | 新しいパスワード設定失敗（パスワード不一致） | E2E-AUTH-031 | バリデーション | 異常系 | 高 | パスワードと確認用パスワードが不一致でエラー表示 | 1. 新しいパスワードに「password123」を入力<br>2. パスワード確認に「password456」を入力<br>3. 「パスワードを変更」ボタンをクリック | ・パスワード確認欄の下に「パスワードが一致しません」エラーメッセージが表示される<br>・画面遷移しない | | | |
| 36 | E2E-AUTH-036 | 新しいパスワード設定失敗（パスワード文字数不足） | E2E-AUTH-031 | バリデーション | 異常系 | 高 | 8文字未満のパスワードでエラー表示 | 1. 新しいパスワードに「pass12」（6文字）を入力<br>2. パスワード確認に「pass12」を入力<br>3. 「パスワードを変更」ボタンをクリック | ・新しいパスワード欄の下に「パスワードは8文字以上で入力してください」エラーメッセージが表示される<br>・画面遷移しない | | | |
| 37 | E2E-AUTH-037 | 新しいパスワード設定失敗（無効なトークン） | E2E-AUTH-031 | エラー処理 | 異常系 | 中 | 無効なトークンでエラー表示 | 1. 無効なトークンのURL (/auth?view=new-password&token=invalid) にアクセス<br>2. 新しいパスワードに「password123」を入力<br>3. パスワード確認に「password123」を入力<br>4. 「パスワードを変更」ボタンをクリック | ・新しいパスワード欄の下に「パスワードの変更に失敗しました」エラーメッセージが表示される<br>・画面遷移しない | | | 実装時のテスト |
| 38 | E2E-AUTH-038 | 新しいパスワード設定からログイン画面への遷移 | E2E-AUTH-031 | 画面遷移 | 正常系 | 中 | 新しいパスワード設定画面からログイン画面に戻れる | 1. 新しいパスワード設定画面で「ログイン画面に戻る」リンクをクリック | ・ログイン画面が表示される<br>・URLが「/auth?view=login」になる | | | |
| 39 | E2E-AUTH-039 | プレースホルダー表示確認（ログイン） | E2E-AUTH-001 | UI | 正常系 | 低 | プレースホルダーが正しく表示される | ログイン画面で入力欄を確認 | ・メールアドレス欄のプレースホルダーが「example@email.com」<br>・パスワード欄のプレースホルダーが「8文字以上」 | | | |
| 40 | E2E-AUTH-040 | プレースホルダー表示確認（新規登録） | E2E-AUTH-012 | UI | 正常系 | 低 | プレースホルダーが正しく表示される | 新規登録画面で入力欄を確認 | ・お名前欄のプレースホルダーが「山田 太郎」<br>・メールアドレス欄のプレースホルダーが「example@email.com」<br>・パスワード欄のプレースホルダーが「8文字以上、英数字混在推奨」 | | | |
| 41 | E2E-AUTH-041 | 入力欄フォーカス状態（ログイン） | E2E-AUTH-001 | UI | 正常系 | 低 | 入力欄フォーカス時にスタイルが変わる | 1. メールアドレス欄をクリック<br>2. パスワード欄をクリック | ・フォーカス時にボーダーがプライマリカラーに変わる<br>・フォーカス時にシャドウが表示される | | | |
| 42 | E2E-AUTH-042 | ボタンホバー状態 | E2E-AUTH-001 | UI | 正常系 | 低 | ボタンにマウスオーバーでスタイルが変わる | 「ログイン」ボタンにマウスオーバー | ・背景色がプライマリライトカラーに変わる<br>・ボタンが上方向に2px移動する<br>・シャドウが表示される | | | |
| 43 | E2E-AUTH-043 | リンクホバー状態 | E2E-AUTH-001 | UI | 正常系 | 低 | リンクにマウスオーバーでスタイルが変わる | 「パスワードを忘れた場合」リンクにマウスオーバー | ・テキストがプライマリライトカラーに変わる<br>・下線が表示される | | | |
| 44 | E2E-AUTH-044 | ボタン無効化状態の確認 | E2E-AUTH-003 | UI | 正常系 | 中 | 送信中はボタンが無効化される | ログイン送信時 | ・ボタンのテキストが「ログイン中...」になる<br>・ボタンが無効化されクリックできない<br>・入力欄も無効化される | | | |
| 45 | E2E-AUTH-045 | エラーメッセージのスタイル確認 | E2E-AUTH-004 | UI | 正常系 | 低 | エラーメッセージが正しいスタイルで表示される | バリデーションエラー発生時 | ・エラーメッセージが赤色(var(--danger))で表示される<br>・フォントサイズが14pxで表示される<br>・入力欄の下に適切な余白で表示される | | | |
| 46 | E2E-AUTH-046 | XSS攻撃対策（メールアドレス） | E2E-AUTH-001 | セキュリティ | セキュリティ | 高 | XSSスクリプトがエスケープされる | 1. メールアドレスに「<script>alert('XSS')</script>@test.com」を入力<br>2. 「ログイン」ボタンをクリック | ・スクリプトが実行されない<br>・バリデーションエラーが表示される<br>・入力値がエスケープされて表示される | | | |
| 47 | E2E-AUTH-047 | XSS攻撃対策（名前） | E2E-AUTH-012 | セキュリティ | セキュリティ | 高 | XSSスクリプトがエスケープされる | 1. お名前に「<img src=x onerror=alert('XSS')>」を入力<br>2. その他の情報を正しく入力<br>3. 「登録してはじめる」ボタンをクリック | ・スクリプトが実行されない<br>・入力値がエスケープされる | | | |
| 48 | E2E-AUTH-048 | SQLインジェクション対策 | E2E-AUTH-001 | セキュリティ | セキュリティ | 高 | SQLインジェクションが防止される | 1. メールアドレスに「' OR '1'='1」を入力<br>2. パスワードに「password123」を入力<br>3. 「ログイン」ボタンをクリック | ・SQLインジェクションが実行されない<br>・バリデーションエラーまたは認証失敗エラーが表示される | | | 実装時のテスト |
| 49 | E2E-AUTH-049 | CSRF保護確認 | E2E-AUTH-001 | セキュリティ | セキュリティ | 中 | CSRFトークンが適切に処理される | フォーム送信時のネットワーク通信を確認 | ・CSRFトークンがリクエストに含まれる（Auth.js標準実装）<br>・トークンなしのリクエストが拒否される | | | 実装時のテスト |
| 50 | E2E-AUTH-050 | セッション管理確認 | E2E-AUTH-003 | セキュリティ | セキュリティ | 中 | セッションCookieが適切に設定される | ログイン成功後のCookieを確認 | ・HttpOnly属性が設定されている<br>・Secure属性が設定されている（本番環境）<br>・SameSite=Laxが設定されている<br>・有効期限が適切に設定されている | | | 実装時のテスト |
| 51 | E2E-AUTH-051 | パスワードマスキング確認 | E2E-AUTH-001 | セキュリティ | セキュリティ | 低 | パスワードが適切にマスキングされる | パスワード入力欄に入力 | ・入力した文字が「●」または「*」で表示される<br>・開発者ツールでも平文が見えない | | | |
| 52 | E2E-AUTH-052 | デスクトップ表示（1920x1080） | E2E-AUTH-001 | レスポンシブ | レスポンシブ | 高 | デスクトップ画面で正しく表示される | 画面サイズ: 1920x1080 | ・認証カードが中央に配置される<br>・最大幅400pxで表示される<br>・全要素が適切に配置される<br>・フォントサイズが読みやすい | | | |
| 53 | E2E-AUTH-053 | タブレット表示（768x1024） | E2E-AUTH-001 | レスポンシブ | レスポンシブ | 高 | タブレット画面で正しく表示される | 画面サイズ: 768x1024 | ・認証カードが中央に配置される<br>・全要素が適切に配置される<br>・スクロールなしで全体が見える<br>・タッチ操作可能なサイズ | | | |
| 54 | E2E-AUTH-054 | モバイル表示（375x667） | E2E-AUTH-001 | レスポンシブ | レスポンシブ | 高 | モバイル画面で正しく表示される | 画面サイズ: 375x667 (iPhone SE) | ・認証カードが画面幅に応じて調整される<br>・パディングが24px/16pxに変更される<br>・フォントサイズが適切に調整される<br>・ボタンがタッチ操作可能なサイズ（最小44x44px）<br>・テキストが折り返され読みやすい | | | |
| 55 | E2E-AUTH-055 | モバイル横向き表示（667x375） | E2E-AUTH-001 | レスポンシブ | レスポンシブ | 中 | モバイル横向きで正しく表示される | 画面サイズ: 667x375 (横向き) | ・認証カードが中央に配置される<br>・縦スクロールで全要素が確認できる<br>・レイアウトが崩れない | | | |
| 56 | E2E-AUTH-056 | 極小画面表示（320x568） | E2E-AUTH-001 | レスポンシブ | レスポンシブ | 低 | 極小画面で正しく表示される | 画面サイズ: 320x568 (iPhone 5/SE) | ・認証カードが画面に収まる<br>・テキストが折り返される<br>・入力欄とボタンが操作可能<br>・水平スクロールが発生しない | | | |
| 57 | E2E-AUTH-057 | ワークフロー: ログイン | E2E-AUTH-001 | ワークフロー | ワークフロー | 高 | ログインワークフローが正しく動作する | 1. /auth にアクセス<br>2. メールアドレスを入力<br>3. パスワードを入力<br>4. ログインボタンをクリック | ・ログイン画面が表示される<br>・入力値が受け付けられる<br>・送信処理が実行される<br>・ホームにリダイレクトされる | | | |
| 58 | E2E-AUTH-058 | ワークフロー: 新規登録 | E2E-AUTH-001 | ワークフロー | ワークフロー | 高 | 新規登録ワークフローが正しく動作する | 1. /auth にアクセス<br>2. 新規登録リンクをクリック<br>3. 名前、メール、パスワードを入力<br>4. 登録ボタンをクリック | ・新規登録画面に遷移する<br>・入力値が受け付けられる<br>・登録処理が実行される<br>・ホームにリダイレクトされる | | | |
| 59 | E2E-AUTH-059 | ワークフロー: パスワードリセット | E2E-AUTH-001 | ワークフロー | ワークフロー | 高 | パスワードリセットワークフローが正しく動作する | 1. /auth にアクセス<br>2. パスワードを忘れた場合リンクをクリック<br>3. メールアドレスを入力<br>4. リセットリンク送信ボタンをクリック<br>5. 成功画面を確認 | ・パスワードリセット画面に遷移する<br>・メールアドレスが受け付けられる<br>・送信処理が実行される<br>・成功画面が表示される | | | |
| 60 | E2E-AUTH-060 | ワークフロー: 新しいパスワード設定 | E2E-AUTH-031 | ワークフロー | ワークフロー | 高 | 新しいパスワード設定ワークフローが正しく動作する | 1. /auth?view=new-password&token=test にアクセス<br>2. 新しいパスワードを入力<br>3. パスワード確認を入力<br>4. 変更ボタンをクリック | ・新しいパスワード設定画面が表示される<br>・パスワードが受け付けられる<br>・変更処理が実行される<br>・ログイン画面に遷移する | | | |
| 61 | E2E-AUTH-061 | ワークフロー: 画面間の往復 | E2E-AUTH-001 | ワークフロー | ワークフロー | 中 | 複数画面間の遷移が正しく動作する | 1. ログイン→新規登録→ログイン<br>2. ログイン→パスワードリセット→ログイン<br>3. 各画面でURLが正しく更新される | ・全ての遷移が正しく実行される<br>・URLパラメータが正しく設定される<br>・各画面のコンテンツが正しく表示される<br>・入力値がクリアされる | | | |
| 62 | E2E-AUTH-062 | ワークフロー: エラーからの復帰 | E2E-AUTH-004 | ワークフロー | ワークフロー | 中 | エラー後に正しく操作を継続できる | 1. バリデーションエラーを発生させる<br>2. 正しい値を再入力する<br>3. フォームを送信する | ・エラーメッセージが表示される<br>・修正後にエラーが消える<br>・正しい値で送信が成功する<br>・ホームにリダイレクトされる | | | |

## テスト分類別カバレッジ
- 正常系: 25項目
- 異常系: 23項目
- セキュリティ: 7項目
- レスポンシブ: 5項目
- ワークフロー: 6項目
- UI: 8項目

## API呼び出し一覧
| No | メソッド | エンドポイント | 用途 | テストID |
|----|---------|--------------|------|----------|
| 1 | Auth.js | signIn('credentials', options) | ログイン | E2E-AUTH-003, E2E-AUTH-009, E2E-AUTH-057 |
| 2 | POST | /api/auth/register | 新規登録 | E2E-AUTH-013, E2E-AUTH-021, E2E-AUTH-058 |
| 3 | POST | /api/auth/password-reset | パスワードリセットリクエスト | E2E-AUTH-024, E2E-AUTH-027, E2E-AUTH-059 |
| 4 | POST | /api/auth/password-reset/confirm | 新しいパスワード設定 | E2E-AUTH-032, E2E-AUTH-037, E2E-AUTH-060 |

## 優先度別実施順序

### 1. 高優先度（必須）: 28項目
基本機能とセキュリティの確認を最優先で実施してください。

**画面表示・初期表示（依存なし）**
- E2E-AUTH-001: ログイン画面の初期表示
- E2E-AUTH-012: 新規登録画面の初期表示
- E2E-AUTH-023: パスワードリセット画面の初期表示
- E2E-AUTH-031: 新しいパスワード設定画面の初期表示

**ログイン機能（E2E-AUTH-001に依存）**
- E2E-AUTH-003: ログイン成功
- E2E-AUTH-004: ログイン失敗（メールアドレス未入力）
- E2E-AUTH-005: ログイン失敗（パスワード未入力）
- E2E-AUTH-007: ログイン失敗（メールアドレス形式エラー）
- E2E-AUTH-008: ログイン失敗（パスワード文字数不足）
- E2E-AUTH-010: 新規登録画面への遷移
- E2E-AUTH-011: パスワードリセット画面への遷移

**新規登録機能（E2E-AUTH-012に依存）**
- E2E-AUTH-013: 新規登録成功
- E2E-AUTH-014: 新規登録失敗（名前未入力）
- E2E-AUTH-016: 新規登録失敗（メールアドレス未入力）
- E2E-AUTH-017: 新規登録失敗（メールアドレス形式エラー）
- E2E-AUTH-018: 新規登録失敗（パスワード未入力）
- E2E-AUTH-019: 新規登録失敗（パスワード文字数不足）
- E2E-AUTH-022: 新規登録からログイン画面への遷移

**パスワードリセット機能（E2E-AUTH-023に依存）**
- E2E-AUTH-024: パスワードリセット成功
- E2E-AUTH-025: パスワードリセット失敗（メールアドレス未入力）
- E2E-AUTH-026: パスワードリセット失敗（メールアドレス形式エラー）
- E2E-AUTH-029: パスワードリセット成功画面の表示（E2E-AUTH-024に依存）

**新しいパスワード設定機能（E2E-AUTH-031に依存）**
- E2E-AUTH-032: 新しいパスワード設定成功
- E2E-AUTH-033: 新しいパスワード設定失敗（新しいパスワード未入力）
- E2E-AUTH-034: 新しいパスワード設定失敗（確認用パスワード未入力）
- E2E-AUTH-035: 新しいパスワード設定失敗（パスワード不一致）
- E2E-AUTH-036: 新しいパスワード設定失敗（パスワード文字数不足）

**セキュリティ（依存関係あり）**
- E2E-AUTH-046: XSS攻撃対策（メールアドレス）（E2E-AUTH-001に依存）
- E2E-AUTH-047: XSS攻撃対策（名前）（E2E-AUTH-012に依存）
- E2E-AUTH-048: SQLインジェクション対策（E2E-AUTH-001に依存）

**レスポンシブ（E2E-AUTH-001に依存）**
- E2E-AUTH-052: デスクトップ表示（1920x1080）
- E2E-AUTH-053: タブレット表示（768x1024）
- E2E-AUTH-054: モバイル表示（375x667）

**ワークフロー（複数テストに依存）**
- E2E-AUTH-057: ワークフロー: ログイン（E2E-AUTH-001に依存）
- E2E-AUTH-058: ワークフロー: 新規登録（E2E-AUTH-001に依存）
- E2E-AUTH-059: ワークフロー: パスワードリセット（E2E-AUTH-001に依存）
- E2E-AUTH-060: ワークフロー: 新しいパスワード設定（E2E-AUTH-031に依存）

### 2. 中優先度（推奨）: 22項目
正常系の拡張ケースとエラーケースを確認してください。

**ログイン関連**
- E2E-AUTH-002: URLパラメータでログイン画面表示
- E2E-AUTH-006: ログイン失敗（両方未入力）（E2E-AUTH-001に依存）
- E2E-AUTH-009: ログイン失敗（API認証エラー）（E2E-AUTH-001に依存）

**新規登録関連**
- E2E-AUTH-015: 新規登録失敗（名前2文字未満）（E2E-AUTH-012に依存）
- E2E-AUTH-020: 新規登録失敗（全フィールド未入力）（E2E-AUTH-012に依存）
- E2E-AUTH-021: 新規登録失敗（メールアドレス重複）（E2E-AUTH-012に依存）

**パスワードリセット関連**
- E2E-AUTH-027: パスワードリセット失敗（存在しないメール）（E2E-AUTH-023に依存）
- E2E-AUTH-028: パスワードリセットからログイン画面への遷移（E2E-AUTH-023に依存）
- E2E-AUTH-030: パスワードリセット成功画面からログイン画面への遷移（E2E-AUTH-029に依存）

**新しいパスワード設定関連**
- E2E-AUTH-037: 新しいパスワード設定失敗（無効なトークン）（E2E-AUTH-031に依存）
- E2E-AUTH-038: 新しいパスワード設定からログイン画面への遷移（E2E-AUTH-031に依存）

**UI関連**
- E2E-AUTH-044: ボタン無効化状態の確認（E2E-AUTH-003に依存）

**セキュリティ関連**
- E2E-AUTH-049: CSRF保護確認（E2E-AUTH-001に依存）
- E2E-AUTH-050: セッション管理確認（E2E-AUTH-003に依存）

**レスポンシブ関連**
- E2E-AUTH-055: モバイル横向き表示（667x375）（E2E-AUTH-001に依存）

**ワークフロー関連**
- E2E-AUTH-061: ワークフロー: 画面間の往復（E2E-AUTH-001に依存）
- E2E-AUTH-062: ワークフロー: エラーからの復帰（E2E-AUTH-004に依存）

### 3. 低優先度（任意）: 12項目
UI/UXの詳細確認を実施してください。

**UI関連（すべてE2E-AUTH-001またはE2E-AUTH-012に依存）**
- E2E-AUTH-039: プレースホルダー表示確認（ログイン）
- E2E-AUTH-040: プレースホルダー表示確認（新規登録）
- E2E-AUTH-041: 入力欄フォーカス状態（ログイン）
- E2E-AUTH-042: ボタンホバー状態
- E2E-AUTH-043: リンクホバー状態
- E2E-AUTH-045: エラーメッセージのスタイル確認（E2E-AUTH-004に依存）

**セキュリティ関連**
- E2E-AUTH-051: パスワードマスキング確認（E2E-AUTH-001に依存）

**レスポンシブ関連**
- E2E-AUTH-056: 極小画面表示（320x568）（E2E-AUTH-001に依存）

## 前提条件

### テスト環境
- テスト環境URL: http://localhost:3247/auth
- ブラウザ: Chrome最新版、Safari最新版、Firefox最新版
- Playwrightテストフレームワーク使用

### テストアカウント
- 既存ユーザー:
  - メールアドレス: test@mentalbase.local
  - パスワード: MentalBase2025!Dev
  - 名前: テストユーザー

### モック実装の制約
現在はモック実装のため、以下の動作となります:
- すべてのフォーム送信は1秒待機後に成功
- 実際のAPI呼び出しは行われない
- メール送信は実行されない
- トークン検証は実装されていない

実装時のテスト項目（「実装時のテスト」と備考欄に記載されているもの）は、API実装後に再テストが必要です。

### 成功判定基準
- 期待結果に記載された全項目が確認できること
- エラーが発生しないこと
- パフォーマンス: ページ表示1秒以内、フォーム送信3秒以内
- アクセシビリティ: Lighthouse Accessibility スコア90以上

## テスト実行上の注意事項

### 依存関係の順守
- 依存テストIDが「なし」のテストから優先的に実施
- 依存テストが成功してから次のテストを実施
- 例: E2E-AUTH-003（ログイン成功）が失敗した場合、E2E-AUTH-044（ボタン無効化状態）はスキップ

### データクリーンアップ
- 各テスト実行前にブラウザのCookie、LocalStorageをクリア
- 新規登録テストではユニークなメールアドレスを使用

### エラー時の対応
- テスト失敗時はスクリーンショットを取得
- コンソールエラーログを記録
- ネットワーク通信をキャプチャ

### 並列実行の制約
- セッション管理系のテストは並列実行不可
- 新規登録テストはDB操作のため直列実行推奨

## 関連ドキュメント

- 要件定義書: `docs/requirements.md` - P-001仕様
- API仕様書: `docs/api-specs/auth-api.md`
- 型定義: `types/index.ts` - 認証関連型定義
- バリデーション: `lib/validation.ts` - フォームバリデーション
- 実装ファイル:
  - `components/auth/AuthPage.tsx` - 認証ページメインコンポーネント
  - `components/auth/LoginForm.tsx` - ログインフォーム
  - `components/auth/RegisterForm.tsx` - 新規登録フォーム
  - `components/auth/PasswordResetForm.tsx` - パスワードリセットフォーム
  - `components/auth/NewPasswordForm.tsx` - 新しいパスワード設定フォーム

## 改訂履歴

| 日付 | バージョン | 変更内容 | 作成者 |
|------|-----------|---------|--------|
| 2025-11-01 | 1.0.0 | 初版作成 | E2Eテスト仕様書作成エージェント |
